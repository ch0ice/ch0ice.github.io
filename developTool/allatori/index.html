<!DOCTYPE html><html class="theme-next pisces use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Damion:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.ico?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="java代码混淆,allatori,"><link rel="alternate" href="/atom.xml" title="Choice's Blog" type="application/atom+xml"><meta name="description" content="前言Allatori是一个Java 混淆器,它属于第二代的混淆器，因此它能够全方位的保护你的知识产权。Allatori完全使用java编写，所以可以运行java代码的环境，都可以使用Allatori。Allatori具有以下几种保护方式：命名混淆，流混淆，调试信息混淆，字符串混淆，以及水印技术。对于教育和非商业项目来说这个混淆器是免费的。新版本支持war和ear文件格式，并且允许对需要混淆代码的应"><meta name="keywords" content="java代码混淆,allatori"><meta property="og:type" content="article"><meta property="og:title" content="java代码混淆之Allatori"><meta property="og:url" content="http://blog.onlinetool.com.cn/developTool/allatori/index.html"><meta property="og:site_name" content="Choice&#39;s Blog"><meta property="og:description" content="前言Allatori是一个Java 混淆器,它属于第二代的混淆器，因此它能够全方位的保护你的知识产权。Allatori完全使用java编写，所以可以运行java代码的环境，都可以使用Allatori。Allatori具有以下几种保护方式：命名混淆，流混淆，调试信息混淆，字符串混淆，以及水印技术。对于教育和非商业项目来说这个混淆器是免费的。新版本支持war和ear文件格式，并且允许对需要混淆代码的应"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http://blog.onlinetool.com.cn/images/allatori-download.png"><meta property="og:image" content="http://blog.onlinetool.com.cn/images/allatori-demo-dir.png"><meta property="og:image" content="http://blog.onlinetool.com.cn/images/allatori-project.png"><meta property="og:updated_time" content="2020-09-25T03:37:14.686Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="java代码混淆之Allatori"><meta name="twitter:description" content="前言Allatori是一个Java 混淆器,它属于第二代的混淆器，因此它能够全方位的保护你的知识产权。Allatori完全使用java编写，所以可以运行java代码的环境，都可以使用Allatori。Allatori具有以下几种保护方式：命名混淆，流混淆，调试信息混淆，字符串混淆，以及水印技术。对于教育和非商业项目来说这个混淆器是免费的。新版本支持war和ear文件格式，并且允许对需要混淆代码的应"><meta name="twitter:image" content="http://blog.onlinetool.com.cn/images/allatori-download.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://blog.onlinetool.com.cn/developTool/allatori/"><title>java代码混淆之Allatori | Choice's Blog</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?90aa63e8cd3863bfdba1f3fdfcd619c1";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"> <a href="https://github.com/ch0ice" class="github-corner" aria-label="View source on Github" rel="external nofollow noopener noreferrer" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></div><header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Choice's Blog</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description"></h1></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br> 站点地图</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://blog.onlinetool.com.cn/developTool/allatori/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Choice"><meta itemprop="description" content=""><meta itemprop="image" content="/uploads/portrait.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Choice's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">java代码混淆之Allatori</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-14T17:08:00+08:00">2018-11-14</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于&#58;</span> <time title="更新于" itemprop="dateModified" datetime="2020-09-25T11:37:14+08:00">2020-09-25</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/开发工具/" itemprop="url" rel="index"><span itemprop="name">开发工具</span></a></span></span> <span class="post-comments-count"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i></span><a href="/developTool/allatori/#comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/developTool/allatori/" itemprop="commentCount"></span></a></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">4,830</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">20</span></div></div></header><div class="post-body" itemprop="articleBody"><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Allatori是一个Java 混淆器,它属于第二代的混淆器，因此它能够全方位的保护你的知识产权。<br>Allatori完全使用java编写，所以可以运行java代码的环境，都可以使用Allatori。<br>Allatori具有以下几种保护方式：命名混淆，流混淆，调试信息混淆，字符串混淆，以及水印技术。<br>对于教育和非商业项目来说这个混淆器是免费的。新版本支持war和ear文件格式，并且允许对需要混淆代码的应用程序添加有效日期。<br><a href="http://www.allatori.com/doc.html" rel="external nofollow noopener noreferrer" target="_blank">点此查看官方文档</a></p><h3 id="为什么要混淆代码？"><a href="#为什么要混淆代码？" class="headerlink" title="为什么要混淆代码？"></a>为什么要混淆代码？</h3><p>Java是一种跨平台的、解释型语言，Java源代码编译成中间“字节码”存储于class文件中。<br>由于跨平台的需要，Java字节码中包括了很多源代码信息，如变量名、方法名，并且通过这些名称来访问变量和方法，这些符号带有许多语义信息，很容易被反编译成Java源代码。<br>为了防止这种现象，我们可以使用Java混淆器对Java字节码进行混淆。</p><h3 id="什么是名称混淆？"><a href="#什么是名称混淆？" class="headerlink" title="什么是名称混淆？"></a>什么是名称混淆？</h3><p>Allatori的名称混淆机制将有意义的类，字段、方法名称更改为无意义的字符串。<br>虽然Allatori是第二代Java混淆器，但它也可以执行出色的名称混淆。<br>与其他一些混淆器不同，它被设计为处理任何类型的依赖和继承方案。<br>Allatori生成的新名称非常短，因此它减少了字节代码的大小。<br>在名称混淆的字节代码中，包，类，字段和方法名称已重命名，并且永远不能恢复原始名称。<br>不幸的是，控制流程仍然清晰可见。<br>这就是为什么我们还需要使用Allatori的Flow Obfuscation（流混淆）。</p><h3 id="什么是流混淆？"><a href="#什么是流混淆？" class="headerlink" title="什么是流混淆？"></a>什么是流混淆？</h3><p>Allatori作为第二代Java混淆器，除了名称混淆之外，还执行流混淆。<br>比如使用了 ‘if’，’switch’，’while’或’for’ 等关键字的方法，会被进行执行流混淆。<br>它对字节码做了细微的修改，模糊了控制流，而不改变代码在运行时的行为。<br>通常情况下，选择和循环等逻辑构造会被更改，因此它们不再具有直接等效的Java源代码。<br>流模糊的字节码通常强制反编译器将一系列标签和非法的“goto”语句插入到它们生成的源代码中。<br>源代码有时会因为反编译错误而变得更加模糊。</p><h3 id="什么是调试信息混淆？"><a href="#什么是调试信息混淆？" class="headerlink" title="什么是调试信息混淆？"></a>什么是调试信息混淆？</h3><p>Allatori使用所有“传统”混淆技术。它会混淆调试信息并重命名所有可能的方法和字段名称。<br>我理解的是Allatori混淆了执行流和类、方法的名称后就达到了调试信息混淆，因为混淆后的代码无法与源代码相对应。</p><h3 id="什么是字符串混淆？"><a href="#什么是字符串混淆？" class="headerlink" title="什么是字符串混淆？"></a>什么是字符串混淆？</h3><p>当竞争对手或黑客反编译混淆的应用程序时，他们会寻找任何他们感兴趣的信息。<br>比如嵌入在应用程序中的字符串文字提供了重要的线索。<br>这些文字可能是：<br>1.调试程序需要的输出。<br>2.错误消息的文本。<br>3.异常消息的文本。<br>在代码中对字符串的简单搜索将会显示其使用位置的确切位置，这意味着它将本地化​​必要的代码片段，从而使黑客更容易理解算法你的程序。<br>字符串文字可以成为探索整个应用程序的起点。<br>Allatori的字符串加密技术对存储在类文件的常量池中的字符串字面值进行加密。<br>在这种情况下，应用程序反编译后的字符串搜索不会给黑客带来任何好处。<br>Allatori将代码片段添加到类中，以便您的字符串在运行时被解密，这意味着表面上一切都将如常。</p><h3 id="什么是软件水印？"><a href="#什么是软件水印？" class="headerlink" title="什么是软件水印？"></a>什么是软件水印？</h3><p>软件水印可以用于将客户标识或版权信息隐藏到软件应用程序中，类似于使用隐写技术将其隐藏在诸如歌曲，电影和图像之类的其他数字内容中。<br>水印可用于识别软件的所有者或跟踪盗版副本的来源。</p><h3 id="混淆器的优势"><a href="#混淆器的优势" class="headerlink" title="混淆器的优势"></a>混淆器的优势</h3><p>混淆就是对发布出去的程序进行重新组织和处理，使得处理后的代码与处理前代码完成相同的功能，而混淆后的代码很难被反编译，即使反编译成功也很难得出程序的真正语义。<br>被混淆过的程序代码，仍然遵照原来的档案格式和指令集，执行结果也与混淆前一样，只是混淆器将代码中的所有变量、函数、类的名称变为简短的英文字母代号，在缺乏相应的函数名和程序注释的况下，即使被反编译，也将难以阅读。<br>同时混淆是不可逆的，在混淆的过程中一些不影响正常运行的信息将永久丢失，这些信息的丢失使程序变得更加难以理解。<br>混淆器的作用不仅仅是保护代码，它也有精简编译后程序大小的作用。<br>由于以上介绍的缩短变量和函数名以及丢失部分信息的原因， 编译后jar文件体积大约能减少25% ，这对当前费用较贵的无线网络传输是有一定意义的。</p><h3 id="Allatori的使用"><a href="#Allatori的使用" class="headerlink" title="Allatori的使用"></a>Allatori的使用</h3><h4 id="下载支持包"><a href="#下载支持包" class="headerlink" title="下载支持包"></a>下载支持包</h4><p>Allatori不需要安装，你需要在<a href="http://www.allatori.com" rel="external nofollow noopener noreferrer" target="_blank">官网</a>下载它的支持包。<br><img src="/developTool/allatori/../../images/allatori-download.png" alt="" title="点击官网的 DEMO DOWNLOAD"><br>下载后的包解压后它长这个样子。<br><img src="/developTool/allatori/../../images/allatori-demo-dir.png" alt="" title="解压后的allatori-demo"><br>它包含allatori的支持包，它在lib目录下，还有allatori的使用教程。<br>我们需要的是lib中的两个jar包，将它放到我们的工程目录中，这里使用maven 构建，你可以选择把它放到项目的根目录中。<br><img src="/developTool/allatori/../../images/allatori-project.png" alt="" title="项目结构"></p><h4 id="编写allatori配置文件"><a href="#编写allatori配置文件" class="headerlink" title="编写allatori配置文件"></a>编写allatori配置文件</h4><p>在项目中新建一个allatori.xml文件，位置和名称不是固定的，看你心情。<br>以下是配置文件的内容。<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jar</span> <span class="attr">in</span>=<span class="string">"allatori-1.0-SNAPSHOT.jar"</span> <span class="attr">out</span>=<span class="string">"new-allatori-1.0-SNAPSHOT.jar"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">classpath</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jar</span> <span class="attr">name</span>=<span class="string">"/Users/choice/.m2/repository/**/*.jar"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">classpath</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">expiry</span> <span class="attr">date</span>=<span class="string">"2000/01/01"</span> <span class="attr">string</span>=<span class="string">"EXPIRED!"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">keep-names</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">class</span> <span class="attr">template</span>=<span class="string">"class * instanceof java.io.Serializable"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">class</span> <span class="attr">template</span>=<span class="string">"class * instanceof java.io.Serializable"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">field</span> <span class="attr">template</span>=<span class="string">"static final long serialVersionUID"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">method</span> <span class="attr">template</span>=<span class="string">"void writeObject(java.io.ObjectOutputStream)"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">method</span> <span class="attr">template</span>=<span class="string">"void readObject(java.io.ObjectInputStream)"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">method</span> <span class="attr">template</span>=<span class="string">"java.lang.Object writeReplace()"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">method</span> <span class="attr">template</span>=<span class="string">"java.lang.Object readResolve()"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">class</span> <span class="attr">access</span>=<span class="string">"protected+"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">field</span> <span class="attr">access</span>=<span class="string">"protected+"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">method</span> <span class="attr">access</span>=<span class="string">"protected+"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">keep-names</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"log-file"</span> <span class="attr">value</span>=<span class="string">"log.xml"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ignore-classes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">class</span> <span class="attr">template</span>=<span class="string">"class *springframework*"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ignore-classes</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">config</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p>配置文件中的内容下面会一一讲解。</p><h4 id="添加Allatori的maven配置"><a href="#添加Allatori的maven配置" class="headerlink" title="添加Allatori的maven配置"></a>添加Allatori的maven配置</h4><p>将以下内容添加到 pom.xml 中。<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置你项目的编译方式 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Allatori config 将Allatori配置文件复制到“目标”目录。目标文件将被过滤(配置文件中使用的Maven属性将被解析)。--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-resources-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">id</span>&gt;</span>copy-and-filter-allatori-config<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>copy-resources<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>$&#123;basedir&#125;/target<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;basedir&#125;/allatori<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>allatori.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Running Allatori --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.mojo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>exec-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">id</span>&gt;</span>run-allatori<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>exec<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executable</span>&gt;</span>java<span class="tag">&lt;/<span class="name">executable</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">arguments</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>-Xms128m<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>-Xmx512m<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>-jar<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>$&#123;basedir&#125;/../lib/allatori.jar<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>$&#123;basedir&#125;/target/allatori.xml<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">arguments</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Allatori plugin end --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><h3 id="常用的Allatori标签"><a href="#常用的Allatori标签" class="headerlink" title="常用的Allatori标签"></a>常用的Allatori标签</h3><p>以下是常用的配置标签，如想看完整的标签，请查看<a href="http://www.allatori.com/doc.html" rel="external nofollow noopener noreferrer" target="_blank">官网文档</a></p><h4 id="config-–-gt-input-tag"><a href="#config-–-gt-input-tag" class="headerlink" title="config –&gt; input tag"></a>config –&gt; input tag</h4><pre><code>input 标签是用来设置混淆源（JAR，WAR，EAR）文件。
它应该包含至少一个嵌套的jar或dir标记来设置输入和输出文件。
input 标签有两个可选属性：
    basedir         可选属性。将根据指定的目录解析jar文件的相对路径。默认情况下，将根据配置文件位置解析相对路径。
    single-jar      可选属性。Allatori将创建一个包含所有混淆类的附加输出jar文件。
</code></pre><h4 id="config-–-gt-input-–-gt-jar-tag"><a href="#config-–-gt-input-–-gt-jar-tag" class="headerlink" title="config –&gt; input –&gt; jar tag"></a>config –&gt; input –&gt; jar tag</h4><pre><code>jar标签有两个必需的属性：
    in          要混淆的jar文件的名称。
    out         输出jar文件的名称。它可以与in相同，在这种情况下，jar将被其混淆版本覆盖。
</code></pre><h4 id="config-–-gt-classpath-tag"><a href="#config-–-gt-classpath-tag" class="headerlink" title="config –&gt; classpath tag"></a>config –&gt; classpath tag</h4><pre><code>classpath 标签是用来设置的类路径混淆应用。
它包含带有jar文件名称的嵌套jar标签。
没有必要引用应用程序所需的所有库jar，但缺少类路径元素可能会导致模糊处理较弱。
Allatori会在混淆过程中警告你所有缺失的class。
classpath 标签有一个可选属性：
    basedir         将根据指定的目录解析jar文件的相对路径。默认情况下，将根据配置文件位置解析相对路径。
</code></pre><h4 id="config-–-gt-classpath-–-gt-jar-tag"><a href="#config-–-gt-classpath-–-gt-jar-tag" class="headerlink" title="config –&gt; classpath –&gt; jar tag"></a>config –&gt; classpath –&gt; jar tag</h4><pre><code>classpath 中的 jar标签有一个必需属性：
    name    要添加到类路径的jar文件的名称。
            允许使用通配符语法：“*”匹配文件名中的任何字符; “**”递归到子目录。
</code></pre><h4 id="config-–-gt-expiry-tag"><a href="#config-–-gt-expiry-tag" class="headerlink" title="config –&gt; expiry tag"></a>config –&gt; expiry tag</h4><pre><code>expiry 标记用于到期日设置为你的应用程序。
有效期限检查被插入到许多方法中，而不仅仅是主要方法，因此不能轻易删除。
此功能可用于混淆甚至没有主方法的库。
expiry 标签有两个必需的属性：
    date            必需的。有效期为yyyy/mm/dd格式。
    string            必需的。如果应用程序在指定的过期日期之后运行，则抛出异常的任何字符串消息。
</code></pre><h4 id="config-–-gt-keep-names-tag"><a href="#config-–-gt-keep-names-tag" class="headerlink" title="config –&gt; keep-names tag"></a>config –&gt; keep-names tag</h4><pre><code>keep-names 标签用于设置不应该在混淆过程被重新命名类，方法和字段名。
如果混淆的应用程序是库，那么您应该保留所有公共API。
对于独立应用程序，您应至少保留主类的名称。
您还应该保留通过反射使用的类和方法的名称。
keep-name 有下列嵌套的标签：
    field           用于指定不重命名的范围。
    method          用于指定不应重命名的方法;
    class           用于指定不应重命名的类。反过来，可以包含嵌套的字段和方法标记。
</code></pre><h4 id="config-–-gt-keep-names-–-gt-class-tag"><a href="#config-–-gt-keep-names-–-gt-class-tag" class="headerlink" title="config –&gt; keep-names –&gt; class tag"></a>config –&gt; keep-names –&gt; class tag</h4><pre><code>class 标签用于匹配的类。
class 它具有以下属性：
access        设置匹配规则，如下：
    private         匹配具有 private 访问权限的类，字段或方法。
    private+        匹配具有 private 或更高访问权限的类，字段或方法。
    package         使用包访问匹配类，字段或方法。
    package+        匹配包及子包的类，字段或方法。
    protected       匹配具有 protected 访问权限的类，字段或方法。
    protected+      匹配具有 protected 或更改访问权限的类，字段或方法。
    public          匹配具有 public 访问权限的类，字段或方法。
template    设置匹配规则。如下：
    class *         匹配所有类和接口。
    interface *     匹配所有接口。
    public class *        匹配所有public的类和接口。
    protected+ class *  匹配所有protected的类和接口。
    class *abc*     匹配以完全限定名包含“abc”的所有类。
    class com.abc.*     匹配com.abc包及其子包中的所有类。
    class *.abc.*       匹配所有“abc”包及其子包中的所有类。
    class * extends java.util.Enumeration    匹配所有继承java.util.Enumeration的所有类。
    class * extends *.Enumeration            匹配所有继承*.Enumeration的类。
    class * instanceof java.io.Serializable    匹配作为java.io.Serializable实例的所有类。
    class * implements *.MouseListener        匹配实现MouseListener的所有类。
    @java.lang.Deprecated class *            匹配所有已弃用的类。
ignore        如果设置为“true”或“yes”，则将重命名匹配的类，但将像往常一样处理嵌套的方法和字段标记。
                它允许保留某些字段和方法的名称，而不保留类的名称。
stop        如果设置为“true”或“yes”，则Allatori将停止对匹配的类应用任何进一步的规则。
</code></pre><h4 id="config-–-gt-keep-names-–-gt-class-–-gt-field-tag"><a href="#config-–-gt-keep-names-–-gt-class-–-gt-field-tag" class="headerlink" title="config –&gt; keep-names –&gt; class –&gt; field tag"></a>config –&gt; keep-names –&gt; class –&gt; field tag</h4><pre><code>field 该标签用于匹配字段。
field 标签具有以下属性：
    access属性设置匹配规则，如下：
        private                                    匹配具有 private 访问权限的类，字段或方法。
        private+                                匹配具有 private 或更高访问权限的类，字段或方法。
        package                                    使用包访问匹配类，字段或方法。
        package+                                匹配包及子包的类，字段或方法。
        protected                                匹配具有 protected 访问权限的类，字段或方法。
        protected+                                匹配具有 protected 或更高访问权限的类，字段或方法。
        public                                    匹配具有 public 访问权限的类，字段或方法。
    template属性具有以下格式：
        *                                        匹配所有字段。
        private *                                匹配所有私有字段。
        private+ *                                匹配所有字段。
        protected+ *                            匹配所有受保护和公共字段。
        static *                                匹配所有静态字段。
        public static *                            匹配所有公共静态字段。
        public int *                            匹配所有公共整数字段。
        java.lang.String *                        匹配所有String字段。
        java.lang.* *                            匹配java.lang包中所有类型的字段。
        abc*                                    匹配名称以“abc”开头的所有字段。
        private abc*                            匹配名称以“abc”开头的所有私有字段。
        * instanceof java.io.Serializable        匹配所有可序列化的字段。
        @java.lang.Deprecated *                    匹配所有已弃用的字段。
</code></pre><h4 id="config-–-gt-keep-names-–-gt-class-–-gt-method-tag"><a href="#config-–-gt-keep-names-–-gt-class-–-gt-method-tag" class="headerlink" title="config –&gt; keep-names –&gt; class –&gt; method tag"></a>config –&gt; keep-names –&gt; class –&gt; method tag</h4><pre><code>method 标签用于匹配的方法。
如果 method 标签嵌套在 class 标签中，则它仅应用于父类标记匹配的类。
如果父标记是 keep-names，则它将应用于所有类。
method 标签具有以下属性：
    access                                            设置匹配规则，规则同行 access 属性
    method标签的template属性具有以下格式：
    [@annotation] [modifiers] [type] methodname（arguments）
    template
    *(**)                                        匹配所有方法。
    private *(**)                                匹配所有私有方法。
    private+ *(**)                                匹配所有方法。
    protected+ *(**)                            匹配所有受保护和公共方法。
    private+ *(*)                                只用一个参数匹配所有方法。
    private+ *(*,*)                                使用两个参数匹配所有方法。
    private+ *(java.lang.String)                使用String类型的一个参数匹配所有方法。
    private+ *(java.lang.String,**)                使用String匹配所有方法作为第一个参数。
    private+ *(java.lang.*)                        匹配所有方法只有一个参数，类型在java.lang包中。
    public get*(**)                                匹配名称以“get”开头的所有公共方法。
    public *abc*(**)                            匹配名称包含“abc”的所有公共方法。
    private+ int *(**)                            匹配int返回类型的所有方法。
    @java.lang.Deprecated *(**)                    匹配所有已弃用的方法。
    parameters                                    如果设置为“keep”，则不会更改方法参数的名称。对公共API方法很有用。  
</code></pre><h4 id="config-–-gt-ignore-classes-tag"><a href="#config-–-gt-ignore-classes-tag" class="headerlink" title="config –&gt; ignore-classes tag"></a>config –&gt; ignore-classes tag</h4><pre><code>ignore-classes标签用于从混淆过程中完全排除一些类。
这些类是“原样”复制的，对输出jar文件没有任何更改。
注意，被忽略的类将引用其他类的原始名称,不能重命名被忽略类引用的类/方法。
</code></pre><h4 id="config-–-gt-ignore-classes-–-gt-class-tag"><a href="#config-–-gt-ignore-classes-–-gt-class-tag" class="headerlink" title="config –&gt; ignore-classes –&gt; class tag"></a>config –&gt; ignore-classes –&gt; class tag</h4><pre><code>与 config --&gt; ignore-classes --&gt; class tag 中的规则相同。
</code></pre><h4 id="config-–-gt-property-tag"><a href="#config-–-gt-property-tag" class="headerlink" title="config –&gt; property tag"></a>config –&gt; property tag</h4><pre><code>property 标签用于设置不同的混淆属性。
property 标签有两个必需的属性 name 和 value：
    普通属性
    log-file            
        filename                        Allatori将把混淆日志写入指定的文件。如果没有设置属性，则不会创建日志文件。
                                        相对路径根据配置文件位置进行解析。
    随机种子
    random-seed         
        any string                      用于初始化随机数生成器的字符串。
    字符串加密属性
    string-encryption
        enable                          (默认情况下)所有可以安全更改加密值的字符串字面值都将被加密。
                                        Allatori将在运行时添加一个方法来解密字符串。
        disable                         字符串加密被禁用。
        maximum                         所有字符串文字将被加密。请参阅下面的限制。
        maximum-with-warnings           所有字符串文字都将被加密。
                                        使用==运算符的每个字符串比较都会产生警告，您将能够用equals（）调用替换这些比较。
    string-encryption-type  
        fast                            (默认)Allatori将使用非常快的字符串加密算法。
        strong                          Allatori将使用强大和棘手的字符串加密算法,不过，速度要慢一些。
    控制流混淆属性
    control-flow-obfuscation
        enable                          Allatori将修改方法的代码。它不会在运行时改变应用程序的行为，但会使反编译过程更加困难。
                                        通常，控制流混淆也使应用程序更小、更快。
        disable                         控制流混淆被禁用。
    extensive-flow-obfuscation
        normal                          (默认情况下)Allatori将使用控制流混淆技术，这将使混乱的应用程序变得更大、更慢。
                                        然而，Allatori将最小化此类代码转换的数量。
        disable                         禁用广泛的控制流混淆。
        maximum                         Allatori将完全使用控制流混淆技术，这使得混淆应用程序变得更大、更慢。
</code></pre><h3 id="混淆前后效果"><a href="#混淆前后效果" class="headerlink" title="混淆前后效果"></a>混淆前后效果</h3><p>混淆前<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">App</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Hello World!"</span>);</span><br><span class="line">        Integer aaaaaaa = <span class="number">127</span>;</span><br><span class="line">        Integer aaaaaaa1 = <span class="number">127</span>;</span><br><span class="line">        System.out.println(aaaaaaa == aaaaaaa1);</span><br><span class="line">        Integer bbbbbbb = <span class="number">128</span>;</span><br><span class="line">        Integer bbbbbbb1 = <span class="number">128</span>;</span><br><span class="line">        System.out.println(bbbbbbb == bbbbbbb1);</span><br><span class="line">        <span class="keyword">int</span> score = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">if</span> (score &gt;= <span class="number">60</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"及格"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (score &lt; <span class="number">85</span>) &#123;</span><br><span class="line">                System.out.println(<span class="string">"良好"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score &gt;= <span class="number">85</span>) &#123;</span><br><span class="line">                System.out.println(<span class="string">"优秀"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>混淆后<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">App</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">ALLATORIxDEMO</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> var10000 = <span class="number">5</span> &lt;&lt; <span class="number">4</span> ^ <span class="number">3</span> &lt;&lt; <span class="number">2</span> ^ <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">int</span> var10001 = (<span class="number">2</span> ^ <span class="number">5</span>) &lt;&lt; <span class="number">4</span> ^ <span class="number">2</span> &lt;&lt; <span class="number">2</span> ^ <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">int</span> var10002 = <span class="number">4</span> &lt;&lt; <span class="number">4</span> ^ <span class="number">4</span> &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> var10003 = s.length();</span><br><span class="line">        <span class="keyword">char</span>[] var10004 = <span class="keyword">new</span> <span class="keyword">char</span>[var10003];</span><br><span class="line">        <span class="keyword">boolean</span> var10006 = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">int</span> var5 = var10003 - <span class="number">1</span>;</span><br><span class="line">        var10003 = var10002;</span><br><span class="line">        <span class="keyword">int</span> var3;</span><br><span class="line">        var10002 = var3 = var5;</span><br><span class="line">        <span class="keyword">char</span>[] var1 = var10004;</span><br><span class="line">        <span class="keyword">int</span> var4 = var10003;</span><br><span class="line">        var10000 = var10002;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> var2 = var10001; var10000 &gt;= <span class="number">0</span>; var10000 = var3) &#123;</span><br><span class="line">            var10001 = var3;</span><br><span class="line">            <span class="keyword">char</span> var6 = s.charAt(var3);</span><br><span class="line">            --var3;</span><br><span class="line">            var1[var10001] = (<span class="keyword">char</span>)(var6 ^ var2);</span><br><span class="line">            <span class="keyword">if</span> (var3 &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            var10002 = var3--;</span><br><span class="line">            var1[var10002] = (<span class="keyword">char</span>)(s.charAt(var10002) ^ var4);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(var1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] var0)</span> </span>&#123;</span><br><span class="line">        System.out.println(ALLATORIxDEMO(<span class="string">"qkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXBXh[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[kqk[h[h[h[hXk[k[h[k[h[hXk[kXk[kXk[kXh[kXk[h[h[h[hXBXh[h[h[hXhXhXh[hXh[hXhXh[k[hXhXhXhXh[k[h[h[h[h[kqk[h[h[h[kXk[k[h[k[h[kXk[hXh[k[k[kXh[hXh[h[h[h[hXBXh[h[h[hXhXhXkXhXkXhXhXh[k[hXkXhXhXhXkXh[h[h[h[kqk[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[hXBXh4*\u001d=\b+\u001a&lt;\u0012'\u0015h\u00191[\t\u0017$\u001a&lt;\u0014:\u0012h4*\u001d=\b+\u001a&lt;\u0014:[&gt;MfMh?\r6\u0007[kqk[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[hXBXh[h[h[h[h[h\u0013&lt;\u000f8AgT?\f?U)\u0017$\u001a&lt;\u0014:\u0012f\u0018'\u0016h[h[h[h[h[h[kqk[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[h[hXBXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkXkq"</span>));</span><br><span class="line">        System.out.println(ALLATORIxDEMO(<span class="string">"\u0000\u001e$\u0017'[\u001f\u0014:\u0017,Z"</span>));</span><br><span class="line">        Integer a = <span class="number">127</span>;</span><br><span class="line">        Integer a = <span class="number">127</span>;</span><br><span class="line">        System.out.println(a == a);</span><br><span class="line">        Integer a = <span class="number">128</span>;</span><br><span class="line">        Integer a = <span class="number">128</span>;</span><br><span class="line">        System.out.println(a == a);</span><br><span class="line">        <span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">10</span> &gt;= <span class="number">60</span>) &#123;</span><br><span class="line">            System.out.println(ALLATORIxDEMO(<span class="string">"厂桇"</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (a &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (a &lt; <span class="number">85</span>) &#123;</span><br><span class="line">                    System.out.println(ALLATORIxDEMO(<span class="string">"舧夆"</span>));</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (a &gt;= <span class="number">85</span>) &#123;</span><br><span class="line">                    System.out.println(ALLATORIxDEMO(<span class="string">"佐离"</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p></div><div><div id="wechat_subscriber" style="display:block;padding:10px 0;margin:20px auto;width:100%;text-align:center"> <img id="wechat_subscriber_qcode" src="/uploads/wechat-qcode.jpg" alt="Choice wechat" style="width:200px;max-width:100%"><div>关注公众号，获取文章更新通知。</div></div></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>坚持原创技术分享，您的支持将鼓励我继续创作！</div> <button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'> <span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"> <img id="wechat_qr" src="/uploads/wechatpay.png" alt="Choice 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"> <img id="alipay_qr" src="/uploads/alipay.png" alt="Choice 支付宝"><p>支付宝</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> Choice</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="http://blog.onlinetool.com.cn/developTool/allatori/" title="java代码混淆之Allatori">http://blog.onlinetool.com.cn/developTool/allatori/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow noopener noreferrer" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/java代码混淆/" rel="tag"># java代码混淆</a> <a href="/tags/allatori/" rel="tag"># allatori</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/developTool/iterm2-ohmyshell/" rel="next" title="iTerm2 + ohMyZsh 打造Mac完美终端"><i class="fa fa-chevron-left"></i> iTerm2 + ohMyZsh 打造Mac完美终端</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/netty/netty-guide-1-io-model/" rel="prev" title="Netty指南（1）--- I/O模型介绍">Netty指南（1）--- I/O模型介绍<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/uploads/portrait.png" alt="Choice"><p class="site-author-name" itemprop="name">Choice</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">5</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">18</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/ch0ice" target="_blank" title="GitHub" rel="external nofollow noopener noreferrer"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:liuzeyuan@163.com" target="_blank" title="邮箱" rel="external nofollow noopener noreferrer"><i class="fa fa-fw fa-envelope"></i> 邮箱</a></span><span class="links-of-author-item"><a href="https://weibo.com/ITwuqing?topnav=1&wvr=6&topsug=1&is_hot=1" target="_blank" title="微博" rel="external nofollow noopener noreferrer"><i class="fa fa-fw fa-weibo"></i> 微博</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/mr_liuzeyuan/activities" target="_blank" title="知乎" rel="external nofollow noopener noreferrer"><i class="fa fa-fw fa-book"></i> 知乎</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为什么要混淆代码？"><span class="nav-number">2.</span> <span class="nav-text">为什么要混淆代码？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是名称混淆？"><span class="nav-number">3.</span> <span class="nav-text">什么是名称混淆？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是流混淆？"><span class="nav-number">4.</span> <span class="nav-text">什么是流混淆？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是调试信息混淆？"><span class="nav-number">5.</span> <span class="nav-text">什么是调试信息混淆？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是字符串混淆？"><span class="nav-number">6.</span> <span class="nav-text">什么是字符串混淆？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是软件水印？"><span class="nav-number">7.</span> <span class="nav-text">什么是软件水印？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#混淆器的优势"><span class="nav-number">8.</span> <span class="nav-text">混淆器的优势</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Allatori的使用"><span class="nav-number">9.</span> <span class="nav-text">Allatori的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#下载支持包"><span class="nav-number">9.1.</span> <span class="nav-text">下载支持包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#编写allatori配置文件"><span class="nav-number">9.2.</span> <span class="nav-text">编写allatori配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#添加Allatori的maven配置"><span class="nav-number">9.3.</span> <span class="nav-text">添加Allatori的maven配置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常用的Allatori标签"><span class="nav-number">10.</span> <span class="nav-text">常用的Allatori标签</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#config-–-gt-input-tag"><span class="nav-number">10.1.</span> <span class="nav-text">config –&gt; input tag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#config-–-gt-input-–-gt-jar-tag"><span class="nav-number">10.2.</span> <span class="nav-text">config –&gt; input –&gt; jar tag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#config-–-gt-classpath-tag"><span class="nav-number">10.3.</span> <span class="nav-text">config –&gt; classpath tag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#config-–-gt-classpath-–-gt-jar-tag"><span class="nav-number">10.4.</span> <span class="nav-text">config –&gt; classpath –&gt; jar tag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#config-–-gt-expiry-tag"><span class="nav-number">10.5.</span> <span class="nav-text">config –&gt; expiry tag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#config-–-gt-keep-names-tag"><span class="nav-number">10.6.</span> <span class="nav-text">config –&gt; keep-names tag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#config-–-gt-keep-names-–-gt-class-tag"><span class="nav-number">10.7.</span> <span class="nav-text">config –&gt; keep-names –&gt; class tag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#config-–-gt-keep-names-–-gt-class-–-gt-field-tag"><span class="nav-number">10.8.</span> <span class="nav-text">config –&gt; keep-names –&gt; class –&gt; field tag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#config-–-gt-keep-names-–-gt-class-–-gt-method-tag"><span class="nav-number">10.9.</span> <span class="nav-text">config –&gt; keep-names –&gt; class –&gt; method tag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#config-–-gt-ignore-classes-tag"><span class="nav-number">10.10.</span> <span class="nav-text">config –&gt; ignore-classes tag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#config-–-gt-ignore-classes-–-gt-class-tag"><span class="nav-number">10.11.</span> <span class="nav-text">config –&gt; ignore-classes –&gt; class tag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#config-–-gt-property-tag"><span class="nav-number">10.12.</span> <span class="nav-text">config –&gt; property tag</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#混淆前后效果"><span class="nav-number">11.</span> <span class="nav-text">混淆前后效果</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2020</span><span class="with-love" id="animate"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Choice</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">Site words total count&#58;</span> <span title="Site words total count">33.4k</span></div><div class="powered-by"><i class="fa fa-user-md"></i> <span id="busuanzi_container_site_uv">本站访客数:<span id="busuanzi_value_site_uv"></span> 次</span></div> <span class="post-meta-divider">|</span><div class="powered-by"> <span id="busuanzi_container_site_pv">本站总访问量:<span id="busuanzi_value_site_pv"></span> 次</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script id="ribbon" type="text/javascript" size="300" alpha="0.6" zindex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: '9SHSaI9JxokTuIBAUR71UrFK-gzGzoHsz',
        appKey: 'SACKdrI10MKOqjRl0GzdREWg',
        placeholder: 'Just go go',
        avatar:'retro',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script><script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script></body></html>